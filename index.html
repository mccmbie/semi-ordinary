<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>semi-ordinary</title>
  <link rel="stylesheet" href="CSS/style.css">
</head>
<body>

<div class="content-wrapper">
  <button id="generate-btn" aria-label="panic button"></button>
  <p id="output"></p>

  <header>
    <h1 id="main-heading">Spinning Text</h1>
    <p>Seen Above is Spinning Text™</p>
    <p>Available to rent out at a very reasonable price.</p>
    <p>Only $7.49 (AUD) a week.</p>
    <p><i>"Apply it to your website... it's <b>worth</b> it!" – Review</i></p>
  </header>

  <br>

  <!-- Payment Button -->
  <button id="payment-btn">Pay Now</button>

  <!-- Pop-up message -->
  <div id="payment-popup">
    <span id="popup-close">×</span>
    <p><b>Sorry</b></p>
    <p>Spinning Text™ is rented to maximum capacity.</p>
    <p>Try again later.</p>
    <p>Thank you.</p>
  </div>

  <main>
    <br>
    <br>
    <br>
    <p>This is a normal paragraph of text.</p>

    <p>
      This sentence has
      <span class="bold">bold text</span>
      and
      <span class="underline">underlined text</span>.
    </p>

    <p>The
      <span class="red"><b>BUTTON</b></span>
      will tell you what you need to hear...
    </p>

    <p class="large-text">
      This text is slightly larger than the rest.
    </p>
  </main>

  <div id="game">
    <p id="game-instructions">Wait for green… then click.</p>

    <div id="game-area">
      <div id="reaction-box"></div>

      <div id="stats">
        <p id="current-time">— ms</p>

        <div id="highscore">
          <p class="title">highscore</p>
          <p id="best-time">— ms</p>
        </div>
      </div>
    </div>

    <p id="fail-message">FAIL</p>
  </div>

  <!-- Name display area - floating above input -->
  <div id="name-display">
    <p id="powered-by-text">Powered by:</p>
    <p id="current-name">—</p>
  </div>

  <!-- Name input area -->
  <div id="name-area">
    <input
      id="name-input"
      type="text"
      placeholder="Enter your name"
    />
    <button id="name-submit">Submit</button>
  </div>

</div>

<div id="draw-controls">
  <button id="draw-toggle">DRAW</button>
  <button id="erase">ERASE</button>
</div>

<canvas id="draw-canvas"></canvas>

<!-- Firebase Script - WITH HISTORY LOGGING -->
<script type="module">
  // Import Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import {
    getDatabase,
    ref,
    set,
    push,
    onValue
  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  // Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyC7-2Znp822GLRFiUf7eQnecFpMVaig6U0",
    authDomain: "semi-ordinary.firebaseapp.com",
    databaseURL: "https://semi-ordinary-default-rtdb.firebaseio.com", // REPLACE WITH YOUR URL
    projectId: "semi-ordinary",
    storageBucket: "semi-ordinary.firebasestorage.app",
    messagingSenderId: "668925450838",
    appId: "1:668925450838:web:a1b4008a98d759f032f9f7"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Grab elements from the page
  const input = document.getElementById("name-input");
  const submit = document.getElementById("name-submit");
  const display = document.getElementById("current-name");

  // References to the database
  const currentNameRef = ref(db, "currentName");
  const historyRef = ref(db, "nameHistory");

  // Function to submit name
  function submitName() {
    const name = input.value.trim();
    if (!name) {
      alert("Please enter a name!");
      return;
    }

    // Get current timestamp
    const timestamp = Date.now();
    const date = new Date(timestamp).toLocaleString();

    // Save to current name (what everyone sees)
    set(currentNameRef, name)
      .then(() => {
        console.log("Name saved successfully!");
        
        // Also save to history with timestamp
        return push(historyRef, {
          name: name,
          timestamp: timestamp,
          date: date
        });
      })
      .then(() => {
        console.log("Name logged to history!");
        input.value = ""; // Clear input
      })
      .catch((error) => {
        console.error("Error saving name:", error);
        alert("Failed to save name. Check console for details.");
      });
  }

  // When user clicks submit button
  submit.addEventListener("click", submitName);

  // When user presses Enter key in the input
  input.addEventListener("keypress", (e) => {
    if (e.key === "Enter") {
      submitName();
    }
  });

  // Listen for live updates to current name
  onValue(currentNameRef, (snapshot) => {
    const name = snapshot.val();
    if (name) {
      display.textContent = name;
      console.log("Name updated to:", name);
    } else {
      display.textContent = "—";
      console.log("No name in database yet");
    }
  });

  console.log("Firebase initialized successfully!");
</script>

<script src="JS/main.js" defer></script>

</body>
</html>
